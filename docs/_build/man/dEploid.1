.\" Man page generated from reStructuredText.
.
.TH "DEPLOID" "1" "August 09, 2016" "v0.2-release" "DEploid"
.SH NAME
dEploid \- 
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.INDENT 0.0
.INDENT 3.5
A software that deconvolutes mixed genomes with unknown proportions.
.UNINDENT
.UNINDENT
.SH SYNOPSIS
.INDENT 0.0
.TP
.B dEploid [ \-vcf \fIfile\fP ] [ \-plaf \fIfile\fP ] [ \-noPanel ] ... [ \-exclude \fIfile\fP ] [ \-vcfOut ] [ \-o \fIstring\fP ] 

.TP
.B dEploid [ \-vcf \fIfile\fP ] [ \-plaf \fIfile\fP ] [ \-panel \fIfile\fP ] ... [ \-exclude \fIfile\fP ] [ \-vcfOut ] [ \-o \fIstring\fP ] 

.UNINDENT
.SH DESCRIPTION
.sp
\fBDEploid\fP is designed for deconvoluting mixed genomes with unknown proportions. Traditional \(aqphasing\(aq programs are limited to diploid organisms. Our method modifies Li and Stephen’s [Li2003] algorithm with Markov chain Monte Carlo (MCMC) approaches, and builds a generic framework that allows haloptype searches in a multiple infection setting.
.sp
\fBDEploid\fP is primarily developed as part of the \fI\%Pf3k\fP project, from which this documentation will take examples from for demonstration. The Pf3k project is a global collaboration using the latest sequencing technologies to provide a high\-resolution view of natural variation in the malaria parasite \fIPlasmodium falciparum\fP\&. Parasite DNA are extracted from patient blood sample, which often contains more than one parasite strain, with unknown proportions. \fBDEploid\fP is used for deconvoluting mixed haplotypes, and reporting the mixture proportions from each sample.
[image: An illustration of mixed infection in malaria]
[image]
.IP [Li2003] 5
Li, N. and M. Stephens (2003). Modeling linkage disequilibrium and identifying recombination hotspots using single\-nucleotide polymorphism data. \fIGenetics\fP 165(4), 2213–2233.
.SH INSTALLATION
.sp
\fBDEploid\fP is written in C++.
.SS Stable Release
.INDENT 0.0
.INDENT 3.5
.SS Todo
.sp
You can download the latest stable release packaged for a variety of different platform from
.UNINDENT
.UNINDENT
.SS Development Version From GitHub
.sp
You can also install \fBDEploid\fP directly from the git repository. Here, you need to install \fBautoconf\fP first:
.sp
On Debian/Ubuntu based systems:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
apt\-get install build\-essential autoconf autoconf\-archive libcppunit\-dev
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
On Mac OS:
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
port install automake autoconf autoconf\-archive cppunit
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
Afterwards you can build the binary using
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
\&./bootstrap
make
.ft P
.fi
.UNINDENT
.UNINDENT
.SH HOW IT WORKS?
.SS Program parameters and options
.SS Mostly used
.INDENT 0.0
.TP
.B \-vcf [\fIfile\fP]
File path of the isolate vcf.
.TP
.B \-plaf [\fIfile\fP]
File path of population level allele frequencies. Text file with population level alternative allele frequency, for example
.UNINDENT
.TS
center;
|l|l|l|.
_
T{
CHROM
T}	T{
POS
T}	T{
PLAF
T}
_
T{
Pf3D7_01_v3
T}	T{
93157
T}	T{
0.0190612159917058
T}
_
T{
Pf3D7_01_v3
T}	T{
94422
T}	T{
0.135502358766423
T}
_
T{
Pf3D7_01_v3
T}	T{
94459
T}	T{
0.156294363760064
T}
_
T{
Pf3D7_01_v3
T}	T{
94487
T}	T{
0.143439298925837
T}
_
.TE
.INDENT 0.0
.TP
.B \-panel [\fIfile\fP]
File path of the reference panel. Reference panel recorded in CSV format, for example
.UNINDENT
.TS
center;
|l|l|l|l|l|l|.
_
T{
CHROM
T}	T{
POS
T}	T{
3D7
T}	T{
Dd2
T}	T{
Hb3
T}	T{
7G8
T}
_
T{
Pf3D7_01_v3
T}	T{
93157
T}	T{
0
T}	T{
0
T}	T{
0
T}	T{
1
T}
_
T{
Pf3D7_01_v3
T}	T{
94422
T}	T{
0
T}	T{
0
T}	T{
0
T}	T{
1
T}
_
T{
Pf3D7_01_v3
T}	T{
94459
T}	T{
0
T}	T{
0
T}	T{
0
T}	T{
1
T}
_
T{
Pf3D7_01_v3
T}	T{
94487
T}	T{
0
T}	T{
0
T}	T{
0
T}	T{
1
T}
_
.TE
.INDENT 0.0
.TP
.B \-noPanel
Use population level allele frequency as prior.
.UNINDENT
.sp
\fBWARNING:\fP
.INDENT 0.0
.INDENT 3.5
Flags \fB\-panel\fP and \fB\-noPanel\fP should not be used together.
.UNINDENT
.UNINDENT
.INDENT 0.0
.TP
.B \-exclude [file]
File path of sites to be excluded.
.TP
.B \-o [string]
Specify the file name prefix of the output.
.TP
.B \-k [int]
Number of strain (default value 5).
.TP
.B \-seed [int]
Random seed.
.TP
.B \-nSample [int]
Number of MCMC samples (default value 800).
.TP
.B \-rate [int]
MCMC sample rate (default value 5).
.TP
.B \-burn [float]
MCMC
.TP
.B \-h , \-help
Help.
.TP
.B \-v , \-version
DEploid version.
.TP
.B \-vcfOut
Save final halpotypes into a VCF file.
.UNINDENT
.SS You may also try
.INDENT 0.0
.TP
.B \-ref [file] \-alt [file]
File path of reference and alternative allele count.
.UNINDENT
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
In early \fBdEploid\fP versions (prior to \fIv0.2\-release\fP), allele counts extracted from the vcf file are placed in two files, and parsed by flags \fB\-ref [file]\fP and \fB\-alt [file]\fP\&. Tab\-delimited plain text for input. First and second columns record chromosome and position labels respectively.  Third columns records the reference allele count, alternative allele count or population level allele frequency. For example,
.UNINDENT
.UNINDENT
.SS reference allele count
.TS
center;
|l|l|l|.
_
T{
CHROM
T}	T{
POS
T}	T{
PG0390.C
T}
_
T{
Pf3D7_01_v3
T}	T{
93157
T}	T{
85
T}
_
T{
Pf3D7_01_v3
T}	T{
94422
T}	T{
77
T}
_
T{
Pf3D7_01_v3
T}	T{
94459
T}	T{
90
T}
_
T{
Pf3D7_01_v3
T}	T{
94487
T}	T{
79
T}
_
.TE
.SS alternative allele count
.TS
center;
|l|l|l|.
_
T{
CHROM
T}	T{
POS
T}	T{
PG0390.C
T}
_
T{
Pf3D7_01_v3
T}	T{
93157
T}	T{
0
T}
_
T{
Pf3D7_01_v3
T}	T{
94422
T}	T{
0
T}
_
T{
Pf3D7_01_v3
T}	T{
94459
T}	T{
0
T}
_
T{
Pf3D7_01_v3
T}	T{
94487
T}	T{
0
T}
_
.TE
.sp
\fBWARNING:\fP
.INDENT 0.0
.INDENT 3.5
Flags \fB\-ref\fP and \fB\-alt\fP should not be used with \fB\-vcf\fP\&.
.UNINDENT
.UNINDENT
.INDENT 0.0
.TP
.B \-forbidUpdateProp
Forbid MCMC moves to update proportions.
.TP
.B \-forbidUpdateSingle
Forbid MCMC moves to update single haplotype.
.TP
.B \-forbidUpdatePair
Forbid MCMC moves to update pair haplotypes.
.TP
.B \-exportPostProb
Save the posterior probabilities of the final iteration of all strains.
.TP
.B \-miss [float]
Miss copying probability
.TP
.B \-recomb [float]
Constant recombination probability
.TP
.B \-initialP [float ...]
Initialize proportions.
.TP
.B \-p [int]
Output precision (default value 8).
.UNINDENT
.SS Data exploration
.sp
Use our data exploration tools to investigate the data.
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
$ R \-\-slave "\-\-args \-vcf tests/testData/PG0389\-C.vcf
 \-plaf tests/testData/labStrains_samples_PLAF.txt
 \-o PG0389\-C " < utilities/dataExplore.r
.ft P
.fi
.UNINDENT
.UNINDENT
[image: Plot alternative allele and reference allele counts to identify evidence of mixed infection in *Pf3k* sample PG0389-C.]
[image]
.INDENT 0.0
.INDENT 3.5
.SS Todo
.sp
Explain a bit more.
.UNINDENT
.UNINDENT
.SH MAKING SENSE OF THE OUTPUT
.SS Output files
.sp
\fBDEploid\fP outputs text files with user\-specified prefix with flag \fB\-o\fP\&.
.INDENT 0.0
.TP
.B \fIprefix\fP\&.log
Log file records _DEploid_ version, input file paths, parameter used and proportion estimates at the final iteration.
.TP
.B \fIprefix\fP\&.llk
Log likelihood of the MCMC chain.
.TP
.B \fIprefix\fP\&.prop
MCMC updates of the proportion estimates.
.TP
.B \fIprefix\fP\&.hap
Haplotypes at the final iteration in plain text file.
.TP
.B \fIprefix\fP\&.vcf
Haplotypes at the final iteration in VCF format.
.UNINDENT
.SS Interpreting the output
.INDENT 0.0
.INDENT 3.5
.SS Todo
.sp
Include r scripts calling for interpreting the data
.UNINDENT
.UNINDENT
.SH EXAMPLE
.INDENT 0.0
.INDENT 3.5
.SH TODO
.sp
Full example of working pipeline.
.UNINDENT
.UNINDENT
.sp
\fBNOTE:\fP
.INDENT 0.0
.INDENT 3.5
Caveat: need to run the program multiple times, because some models are harder than the others.
.UNINDENT
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.sp
.nf
.ft C
$ ./dEploid \-ref labStrains/PG0390_first100ref.txt \e
\-alt labStrains/PG0390_first100alt.txt \e
\-plaf labStrains/labStrains_first100_PLAF.txt \e
\-panel labStrains/lab_first100_Panel.txt \e
\-o tmp1
.ft P
.fi
.UNINDENT
.UNINDENT
.sp
###Input examples :
\fB\(gabash
./dEploid \-ref labStrains/PG0390_first100ref.txt \-alt labStrains/PG0390_first100alt.txt \-plaf labStrains/labStrains_first100_PLAF.txt \-panel labStrains/lab_first100_Panel.txt \-o tmp1
./dEploid \-ref labStrains/PG0390_first100ref.txt \-alt labStrains/PG0390_first100alt.txt \-plaf labStrains/labStrains_first100_PLAF.txt \-panel labStrains/lab_first100_Panel.txt \-nSample 100 \-rate 3
\(ga\fP
.SH REPORTING BUGS
.sp
If you encounter any problem when using _DEploid, please file a short bug report by using the \fI\%issue tracker\fP
on GitHub or email joe.zhu (at) well.ox.ac.uk.
.sp
Please include the output of \fBdEploid \-v\fP and the platform you are using \fBdEploid\fP on in the report. If the problem occurs while executing \fBdEploid\fP, please also include the command you are using and the random seed.
.sp
Thank you!
.SH CITING DEPLOID
.sp
If you use \fBDEploid\fP in your work, please cite the program:
.sp
Sha Zhu, DEploid (2016). \fIGitHub repository\fP, \fI\%https://github.com/mcveanlab/DEploid\fP [accessed DATE]
.SH DOCUMENTATION FOR FUNCTIONS AND CLASSES
.INDENT 0.0
.TP
.B class AtMarker
.UNINDENT
.INDENT 0.0
.TP
.B spam(eggs)
.TP
.B ham(eggs)
Spam or ham the foo.
.UNINDENT
.INDENT 0.0
.TP
.B \-r revision
Specify the revision to work upon.
.UNINDENT
.INDENT 0.0
.TP
.B $.getJSON(href, callback[, errback])
.INDENT 7.0
.TP
.B Arguments
.INDENT 7.0
.IP \(bu 2
\fBhref\fP (\fIstring\fP) \-\- An URI to the location of the resource.
.IP \(bu 2
\fBcallback\fP \-\- Gets called with the object.
.IP \(bu 2
\fBerrback\fP \-\- Gets called in case the request fails. And a lot of other
text so we need multiple lines.
.UNINDENT
.TP
.B Throws
\fBSomeError\fP \-\- For whatever reason in that case.
.TP
.B Returns
Something.
.UNINDENT
.UNINDENT
.SH AUTHOR
Sha (Joe) Zhu
.SH COPYRIGHT
2016, Sha (Joe) Zhu
.\" Generated by docutils manpage writer.
.
